<!doctype html>
<!-- paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ -->
<!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en"> <![endif]-->
<!-- Consider adding a manifest.appcache: h5bp.com/d/Offline -->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->


<head>
  <meta charset="utf-8">

  <!-- Use the .htaccess and remove these lines to avoid edge case issues.
       More info: h5bp.com/b/378 
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  -->

  <title> National Social Security Fund</title>
  <meta name="description" content="">
  <meta name="author" content="">

  <!-- Mobile viewport optimization h5bp.com/ad -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0">

  <!-- Place favicon.ico and apple-touch-icon.png in the root directory: mathiasbynens.be/notes/touch-icons -->
  <!--<link rel="stylesheet" href="less/libs/jquery.mobile.custom.structure.min.css">-->
  <link rel="stylesheet" href="less/libs/jquery.mobile-1.1.1.css">
  <link rel="stylesheet" href="less/libs/flexslider.css">
  <link rel="stylesheet" href="less/photoswipe/photoswipe.css">



    
  <!-- LESS converted to css and minified via build script -->
  <link rel="stylesheet/less" href="less/style414d.html?internal-theme=@green">
  <script src="js/libs/less-1.1.4.js"></script>
  <!-- end LESS -->
  <!-- fonts -->
  <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600' rel='stylesheet' type='text/css'>

  <!-- More ideas for your <head> here: h5bp.com/d/head-Tips -->

  <!-- All JavaScript at the bottom, except this Modernizr build incl. Respond.js
       Respond is a polyfill for min/max-width media queries. Modernizr enables HTML5 elements & feature detects;
       for optimal performance, create your own custom Modernizr build: www.modernizr.com/download/ -->
  <script src="js/libs/modernizr-2.0.6.min.js"></script>
  

</head>

<body>
  <header>

  </header>
  <div role="main">
    
    <div id="miniPage" data-role="page" class="page innerPage">
      <div class="topGrahic"></div>
      <a href="index.html" class="menuButton">
        <img src="img/menu-button.png" alt="Menu">
      </a>
      <div class="padpage padtop">
        <h1><a class="back" href="selfservice.html"><img src="img/icon-back.png" alt="Back"> Mini Statement</a></h1>
        <p>
          Access our services from the comfort of your office, home or on the go anywhere in the world.
        </p>
      </div>
    
      
    
<div class="padpage padbottom"> 
	<!--<button id="logout_btn2">Log Out</button>-->   
    <!--<input type="submit" class="button buttonStrong right" value="Log Out" id="logout_btn2">
      <a href="#" id="logout_btn2" class="button button7">Log Out</a>-->
              <div id="mini">
                  <form action="" method="post" name="login">
                        <label for="number" id="number_label">NSSF Number</label>
                        <input name="number" id="number" type="text">
                        <div class="alert" id="number_alert">
                            <div class="typo-icon">
                            NSSF Number is required.
                            </div>
                        </div>
                        <label for="password" id="password_label">Password</label>
                        <input name="password" id="password" type="password">
                        <div class="alert" id="password_alert">
                            <div class="typo-icon">
                            Password is required.
                            </div>
                        </div>
                        <input type="submit" class="button buttonStrong right" value="Log in" name="buttonSubmit" id="submit_btn">
                        <!--<a id="submit_btn" class="button button7">Submit</a>-->
                  </form>
              </div>
    
</div>       
      
<script>
$('#miniPage').on('pagebeforeshow',function(event){
	$('.alert').hide();
	$('#logout_btn2').hide();
	$('.loading').hide();
	});
	
	/*$("a:jqmData(clickload='logout')").on('click', function() {
		console.log('clicked logout');
		//$.mobile.showPageLoadingMsg("b", "This is only a test", true);
	});*/
	
	$('#logout_btn2').live('click', function(e) {
		var url = $(this).attr('href');
		$.mobile.changePage( url, { reloadPage: true, transition: "none"} );
	});
					
					
			

            $(function(){
				$('.alert').hide();
				$('#logout_btn2').hide();
				$('#submit_btn').click(function(){
					$('.alert').hide();
					var number = $('input#number').val();
					if(number == '')
					{
						$('div#number_alert').show();
						$('input#number').focus();
						return false;
					}
					var password = $('input#password').val();
					if(password == '')
					{
						$('div#password_alert').show();
						$('input#password').focus();
						return false;
					}
					var dataString = 'number=' + number + '&password=' + password + '&limit=true';
					
					var ajax_load = "<img class='loading' src='img/ajax-loader.gif' alt='loading...' />";
					//var loadUrl = "http://localhost/nssf/mobile/estatement";
					
					$("#mini").prepend(ajax_load);
					
					var output = $('#mini');
					$.ajax({
						url: 'http://nssfug.org/apimembers/getMStatement/?'+dataString,
						dataType: 'jsonp',
						jsonp: 'jsoncallback',
						timeout: 50000,
						success: function(data, status){
							if(data.error_no[0]==1)
							{
								 $('.loading').hide();
								 $("#mini").prepend('<div class="alert"><div class="typo-icon">No contributions found for the last 30 months.</div></div>');
								 
							}
							else if(data.error_no[0]==2)
							{
								$('.loading').hide();
								 $("#mini").prepend('<div class="alert"><div class="typo-icon">NSSF Number & password do not match.</div></div>');
							}
							else
							{
									//console.log(data);									
									$('#mini').html('');
									$('#mini').append('<a href="#" id="logout_btn2" data-role="button" data-clickload="logout">Log Out</a>');
									$('#mini').append('<h3>'+data.name+'</h3>');
									$('#mini').append('<h4>'+data.begin+' to '+data.end+'</h4>');
									var cont = '<table cellpadding="0" cellspacing="0" class="table3" width="99%">'+
															'<tr>'+
															'<thead>'+
																'<th>Type</th>'+
																'<th>Date</th>'+
																'<th>Amount</th>'+
															'</thead>'+
															'<tbody>';
															
									$.each(data.tr, function(i,item){ 
										//var tr = item.split(';');
										var amt = addCommas(parseInt(item.amt));
										cont += '<tr><td>'+item.type+'</td><td>'+item.date+'</td><td>'+amt+'</td></tr>';	
									});	
									
									cont += '</tbody></tr></table>';
									
									$('#mini').append(cont);					
									
									$('#mini').trigger('create');
									$('tr:last').css({fontWeight:'bolder'});
									$('tr:last').css({border-top-width: "1px",border-top-style: "solid",border-top-color: "#333"});
									
							}
						},
						error: function(){
							$('.loading').hide();
							$("#mini").prepend('<div class="alert"><div class="typo-icon">The connection to the server timed out. Please check your internet connection.</div></div>');
						}
					});

					 
					return false;
				});	
				
				
									
			});
            
            </script>       
    
    
      
    
      
      
      <div class="padpage padbottom">
        
        
        
        <div class="footer">
          <div class="social right">
            
            <a href="http://twitter.com/nssfug/" target="_blank"> <img src="img/icon-twitter.png" alt="Follow us on Twitter"></a>
            <a href="http://facebook.com/nssfug/" target="_blank"> <img src="img/icon-facebook.png" alt="Like us on Facebook"></a>
          </div>
          
          <div class="copyright left">
            Copyright &copy;  National Social Security Fund
          </div>
          
          <div class="clearfix"></div>
        </div>
        <!--end footer-->
        
      </div>
      <!--end padpage-->
    </div>
    <!--end menuPage-->
    
  </div>
  
  <footer>

  </footer>



  <!-- JavaScript at the bottom for fast page loading -->

  <!-- Grab Google CDN's jQuery, with a protocol relative URL; fall back to local if offline -->
         
 <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="js/libs/jquery-1.8.1.min.js"><\/script>')</script>


  <script type="text/javascript">
    $(document).bind("mobileinit", function(){
      $.mobile.defaultPageTransition = 'fade';
      $.mobile.ignoreContentEnabled = true;
      $.mobile.page.prototype.options.domCache = false;

      //$.mobile.ajaxEnabled = false;
    });
  </script>

  <script src="js/libs/iscroll.js"></script>
  <script src="js/libs/jquery.mobile-1.1.1.min.js"></script>
  <script src="js/libs/jquery.flexslider-min.js"></script>
  <script src="js/photoswipe/klass.min.js"></script>
  <script src="js/photoswipe/code.photoswipe.jquery-3.0.5.min.js"></script>
  <script src="http://maps.google.com/maps/api/js?sensor=false"></script>
  <script src="js/MobileDetect.js"></script>
  


  
  <!-- scripts concatenated and minified via build script -->
  <script defer src="js/plugins.js"></script>
  <script defer src="js/script.js"></script>
  <!-- end scripts -->


  <!-- Prompt IE 6 users to install Chrome Frame. Remove this if you want to support IE 6.
       chromium.org/developers/how-tos/chrome-frame-getting-started -->
  <!--[if lt IE 7 ]>
    <script defer src="//ajax.googleapis.com/ajax/libs/chrome-frame/1.0.3/CFInstall.min.js"></script>
    <script defer>window.attachEvent('onload',function(){CFInstall.check({mode:'overlay'})})</script>
  <![endif]-->

</body>


</html>
